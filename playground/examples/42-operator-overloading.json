{
  "order": 42,
  "title": "Operator Overloading",
  "snippet": "Define custom behavior for operators on user types",
  "description": "Operator overloading enables defining custom behavior for operators (+, -, *, /, ==, [], etc.) on user-defined types. This makes custom types behave like built-in types, improving code readability and expressiveness. Operators are implemented as special methods with reserved names (__add__, __sub__, __mul__, etc.) inside struct definitions. BPL supports 24 operator overloads including arithmetic, comparison, bitwise, unary, indexing, and callable operators. The compiler automatically resolves operator expressions to method calls during type checking. This example demonstrates arithmetic and comparison operators on a Vec2 struct.",
  "code": [
    "struct Vec2 {",
    "    x: float,",
    "    y: float,",
    "    ",
    "    # Addition operator: v1 + v2",
    "    frame __add__(this: *Vec2, other: Vec2) ret Vec2 {",
    "        local result: Vec2 = Vec2 { x: this.x + other.x, y: this.y + other.y };",
    "        return result;",
    "    }",
    "    ",
    "    # Subtraction operator: v1 - v2",
    "    frame __sub__(this: *Vec2, other: Vec2) ret Vec2 {",
    "        local result: Vec2 = Vec2 { x: this.x - other.x, y: this.y - other.y };",
    "        return result;",
    "    }",
    "    ",
    "    # Multiplication by scalar: v * scalar",
    "    frame __mul__(this: *Vec2, scalar: float) ret Vec2 {",
    "        local result: Vec2 = Vec2 { x: this.x * scalar, y: this.y * scalar };",
    "        return result;",
    "    }",
    "    ",
    "    # Equality operator: v1 == v2",
    "    frame __eq__(this: *Vec2, other: Vec2) ret bool {",
    "        return (this.x == other.x) && (this.y == other.y);",
    "    }",
    "}",
    "",
    "extern printf(fmt: string, ...);",
    "",
    "frame main() ret int {",
    "    # Create vectors",
    "    local v1: Vec2 = Vec2 { x: 3.0, y: 4.0 };",
    "    local v2: Vec2 = Vec2 { x: 1.0, y: 2.0 };",
    "    ",
    "    # Use overloaded + operator",
    "    local sum: Vec2 = v1 + v2;",
    "    printf(\"v1 + v2 = (%.1f, %.1f)\\n\", sum.x, sum.y);",
    "    ",
    "    # Use overloaded - operator",
    "    local diff: Vec2 = v1 - v2;",
    "    printf(\"v1 - v2 = (%.1f, %.1f)\\n\", diff.x, diff.y);",
    "    ",
    "    # Use overloaded * operator",
    "    local scaled: Vec2 = v1 * 2.0;",
    "    printf(\"v1 * 2 = (%.1f, %.1f)\\n\", scaled.x, scaled.y);",
    "    ",
    "    # Use overloaded == operator",
    "    local same: bool = v1 == v1;",
    "    local different: bool = v1 == v2;",
    "    printf(\"v1 == v1: %d\\n\", same);",
    "    printf(\"v1 == v2: %d\\n\", different);",
    "    ",
    "    return 0;",
    "}"
  ]
}
