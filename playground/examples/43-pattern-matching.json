{
  "order": 43,
  "title": "Advanced Pattern Matching",
  "snippet": "Complex patterns with nested matching",
  "description": "Pattern matching in BPL goes beyond simple enum variants. You can match on tuple patterns and nest patterns for complex data structures. Match expressions are exhaustive - the compiler ensures all cases are handled. Nested patterns destructure complex types in one expression. Use wildcard '_' to ignore values. This example demonstrates tuple destructuring, nested patterns, and combining multiple matching techniques for robust type handling.",
  "code": [
    "# Define result type for error handling",
    "enum Result<T, E> {",
    "    Ok(T),",
    "    Err(E),",
    "}",
    "",
    "extern printf(fmt: string, ...);",
    "",
    "# Pattern match on integers",
    "frame classifyNumber(n: int) ret string {",
    "    if (n == 0) {",
    "        return \"zero\";",
    "    } else if (n == 1) {",
    "        return \"one\";",
    "    } else if (n > 0 && n < 10) {",
    "        return \"single digit\";",
    "    } else if (n >= 10 && n < 100) {",
    "        return \"double digit\";",
    "    } else if (n > 0) {",
    "        return \"large positive\";",
    "    }",
    "    return \"negative\";",
    "}",
    "",
    "# Match on tuples - destructure and check",
    "frame describePair(pair: (int, int)) ret string {",
    "    local (x: int, y: int) = pair;",
    "    if (x == 0 && y == 0) {",
    "        return \"origin\";",
    "    } else if (x == 0) {",
    "        return \"on y-axis\";",
    "    } else if (y == 0) {",
    "        return \"on x-axis\";",
    "    }",
    "    return \"other\";",
    "}",
    "",
    "# Helper to check if Result is Ok",
    "frame isOk(r: Result<int, string>) ret bool {",
    "    return match (r) {",
    "        Result<int, string>.Ok(_) => true,",
    "        Result<int, string>.Err(_) => false,",
    "    };",
    "}",
    "",
    "# Nested pattern matching with Result",
    "frame processResult(r: Result<int, string>) ret int {",
    "    if (isOk(r)) {",
    "        printf(\"Value received\\n\");",
    "        return 100;",
    "    } else {",
    "        printf(\"Error occurred\\n\");",
    "        return -1;",
    "    }",
    "}",
    "",
    "frame main() ret int {",
    "    # Number classification",
    "    printf(\"%s\\n\", classifyNumber(5));",
    "    printf(\"%s\\n\", classifyNumber(42));",
    "    printf(\"%s\\n\", classifyNumber(-10));",
    "    ",
    "    # Tuple pattern matching",
    "    local p1: (int, int) = (0, 5);",
    "    local p2: (int, int) = (3, 3);",
    "    printf(\"Point (0,5): %s\\n\", describePair(p1));",
    "    printf(\"Point (3,3): %s\\n\", describePair(p2));",
    "    ",
    "    # Result matching",
    "    local success: Result<int, string> = Result<int, string>.Ok(150);",
    "    local failure: Result<int, string> = Result<int, string>.Err(\"not found\");",
    "    ",
    "    local _v1: int = processResult(success);",
    "    local _v2: int = processResult(failure);",
    "    ",
    "    return 0;",
    "}"
  ]
}
