{
  "order": 39,
  "title": "Nested Structs",
  "snippet": "Define structs within structs",
  "description": "Nested structs enable hierarchical data organization by embedding structs within other structs. This composition pattern models has-a relationships (a Person has an Address). Access nested members with chained operators: person.address.city. Nested structs are stored inline (part of the parent's memory), unlike pointers which reference separate allocations. Deep nesting can make code verbose - consider methods or helper functions. Nested structs are common in: complex data models (user profiles), scene graphs (3D transformations), protocol implementations (layered headers). This example demonstrates nested struct definition, initialization, and multi-level member access.",
  "code": [
    "# Document with nested structures",
    "struct Metadata {",
    "    author: string,",
    "    version: int,",
    "    createdYear: int,",
    "}",
    "",
    "struct Content {",
    "    title: string,",
    "    body: string,",
    "    wordCount: int,",
    "}",
    "",
    "struct Document {",
    "    meta: Metadata,",
    "    content: Content,",
    "}",
    "",
    "frame Document_new(author: string, title: string, body: string) ret Document {",
    "    local metadata: Metadata;",
    "    metadata.author = author;",
    "    metadata.version = 1;",
    "    metadata.createdYear = 2025;",
    "    ",
    "    local content: Content;",
    "    content.title = title;",
    "    content.body = body;",
    "    content.wordCount = 42;",
    "    ",
    "    local doc: Document;",
    "    doc.meta = metadata;",
    "    doc.content = content;",
    "    return doc;",
    "}",
    "",
    "frame Document_getInfo(this: Document) ret void {",
    "    printf(\"Document: %s\\n\", this.content.title);",
    "    printf(\"Author: %s\\n\", this.meta.author);",
    "    printf(\"Version: %d\\n\", this.meta.version);",
    "    printf(\"Created: %d\\n\", this.meta.createdYear);",
    "    printf(\"Words: %d\\n\", this.content.wordCount);",
    "}",
    "",
    "frame Document_updateVersion(this: *Document) ret void {",
    "    this.meta.version = this.meta.version + 1;",
    "    printf(\"Document updated to version %d\\n\", this.meta.version);",
    "}",
    "",
    "# Company structure",
    "struct Address {",
    "    street: string,",
    "    city: string,",
    "    country: string,",
    "}",
    "",
    "struct Employee {",
    "    name: string,",
    "    title: string,",
    "    salary: int,",
    "}",
    "",
    "struct Company {",
    "    name: string,",
    "    address: Address,",
    "    ceo: Employee,",
    "}",
    "",
    "frame Company_new(name: string, ceo_name: string) ret Company {",
    "    local addr: Address;",
    "    addr.street = \"123 Business Ave\";",
    "    addr.city = \"Tech City\";",
    "    addr.country = \"USA\";",
    "    ",
    "    local employee: Employee;",
    "    employee.name = ceo_name;",
    "    employee.title = \"Chief Executive Officer\";",
    "    employee.salary = 500000;",
    "    ",
    "    local company: Company;",
    "    company.name = name;",
    "    company.address = addr;",
    "    company.ceo = employee;",
    "    return company;",
    "}",
    "",
    "frame Company_printInfo(this: Company) ret void {",
    "    printf(\"Company: %s\\n\", this.name);",
    "    printf(\"Address: %s, %s, %s\\n\", this.address.street, this.address.city, this.address.country);",
    "    printf(\"CEO: %s (%s)\\n\", this.ceo.name, this.ceo.title);",
    "}",
    "",
    "extern printf(fmt: string, ...);",
    "",
    "frame main() ret int {",
    "    printf(\"=== Nested Structs Example ===\\n\\n\");",
    "    ",
    "    # Create and use a document",
    "    printf(\"Document Example:\\n\");",
    "    local doc: Document = Document_new(\"John Doe\", \"My Article\", \"This is the content...\");",
    "    Document_getInfo(doc);",
    "    Document_updateVersion(&doc);",
    "    ",
    "    printf(\"\\nCompany Example:\\n\");",
    "    # Create and use a company",
    "    local company: Company = Company_new(\"TechCorp\", \"Alice Smith\");",
    "    Company_printInfo(company);",
    "    ",
    "    printf(\"\\nAccessing nested fields directly:\\n\");",
    "    printf(\"CEO name: %s\\n\", company.ceo.name);",
    "    printf(\"City: %s\\n\", company.address.city);",
    "    printf(\"Document author: %s\\n\", doc.meta.author);",
    "    printf(\"Document title: %s\\n\", doc.content.title);",
    "    ",
    "    return 0;",
    "}"
  ]
}
