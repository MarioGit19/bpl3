{
  "order": 40,
  "title": "Bit Manipulation Advanced",
  "snippet": "Advanced bitwise operations and bit fields",
  "description": "Learn advanced bit manipulation techniques including bit shifting, masking, and working with individual bits. Useful for low-level programming and performance optimization.",
  "code": "extern printf(fmt: string, ...);\n\n# Utility functions for bit manipulation\nframe getBit(num: int, pos: int) ret int {\n    return (num >> pos) & 1;\n}\n\nframe setBit(num: int, pos: int) ret int {\n    return num | (1 << pos);\n}\n\nframe clearBit(num: int, pos: int) ret int {\n    return num & ~(1 << pos);\n}\n\nframe toggleBit(num: int, pos: int) ret int {\n    return num ^ (1 << pos);\n}\n\nframe countSetBits(num: int) ret int {\n    local count: int = 0;\n    local temp: int = num;\n    loop (temp > 0) {\n        if ((temp & 1) == 1) {\n            count = count + 1;\n        }\n        temp = temp >> 1;\n    }\n    return count;\n}\n\nframe isPowerOfTwo(num: int) ret bool {\n    if (num <= 0) {\n        return false;\n    }\n    local result: int = num & (num - 1);\n    if (result == 0) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\nframe printBinary(num: int) ret void {\n    printf(\"Binary: \");\n    local i: int = 31;\n    loop (i >= 0) {\n        local bit: int = (num >> i) & 1;\n        printf(\"%d\", bit);\n        if ((i > 0) && ((i % 8) == 0)) {\n            printf(\" \");\n        }\n        i = i - 1;\n    }\n    printf(\"\\n\");\n}\n\nframe main() ret int {\n    printf(\"=== Advanced Bit Manipulation ===\\n\\n\");\n    \n    local num: int = 42;\n    printf(\"Number: %d\\n\", num);\n    printBinary(num);\n    \n    # Get individual bits\n    printf(\"\\nBit Extraction:\\n\");\n    local bit0: int = getBit(num, 0);\n    local bit5: int = getBit(num, 5);\n    printf(\"Bit at position 0: %d\\n\", bit0);\n    printf(\"Bit at position 5: %d\\n\", bit5);\n    \n    # Set bits\n    printf(\"\\nSet Bit (position 0):\\n\");\n    local set_result: int = setBit(num, 0);\n    printf(\"Result: %d\\n\", set_result);\n    printBinary(set_result);\n    \n    # Clear bits\n    printf(\"\\nClear Bit (position 1):\\n\");\n    local clear_result: int = clearBit(num, 1);\n    printf(\"Result: %d\\n\", clear_result);\n    printBinary(clear_result);\n    \n    # Toggle bits\n    printf(\"\\nToggle Bit (position 3):\\n\");\n    local toggle_result: int = toggleBit(num, 3);\n    printf(\"Result: %d\\n\", toggle_result);\n    printBinary(toggle_result);\n    \n    # Count set bits\n    printf(\"\\nBit Operations:\\n\");\n    local bits_set: int = countSetBits(num);\n    printf(\"Number of set bits in %d: %d\\n\", num, bits_set);\n    \n    # Check powers of two\n    printf(\"\\nPower of Two Check:\\n\");\n    local pow_64: int = 64;\n    local pow_100: int = 100;\n    if (isPowerOfTwo(pow_64)) {\n        printf(\"%d is a power of 2\\n\", pow_64);\n    }\n    if (isPowerOfTwo(pow_100)) {\n        printf(\"%d is a power of 2\\n\", pow_100);\n    } else {\n        printf(\"%d is NOT a power of 2\\n\", pow_100);\n    }\n    \n    # Bitwise operations\n    printf(\"\\nBitwise Operations:\\n\");\n    local a: int = 12;  # 1100 in binary\n    local b: int = 10;  # 1010 in binary\n    printf(\"a = %d\\n\", a);\n    printBinary(a);\n    printf(\"b = %d\\n\", b);\n    printBinary(b);\n    printf(\"a & b (AND) = %d\\n\", a & b);\n    printf(\"a | b (OR) = %d\\n\", a | b);\n    printf(\"a ^ b (XOR) = %d\\n\", a ^ b);\n    printf(\"~a (NOT) = %d\\n\", ~a);\n    \n    return 0;\n}"
}
